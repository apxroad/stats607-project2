# ADEMP — STATS 607 Project 2
**Aims, Data, Estimand, Methods, Performance** for the Pólya / Dirichlet–Process predictive study
(§2.4 of Fortini & Petrone, 2024).

---

## A — Aims
1) **Validate DP/Pólya marginal laws** for masses F((−∞, t]) under a DP(α, G₀) prior (prior & posterior).
2) **Check predictive learning behaviour** (PIT ≈ Uniform, convergence of predictive CDFs Pₘ).
3) **Reproduce Proposition 2.6 CIs** for the *limit* mass F̃(t) using **predictive-only** information and assess coverage.

---

## D — Data
Synthetic streams generated by the **Blackwell–MacQueen Pólya urn** with base **G₀ ∈ {Uniform(0,1), Normal(0,1)}** and concentration **α ∈ {1,5,20}**.  
We work at thresholds **t ∈ {0.25, 0.5, 0.75}**. For coverage experiments we vary **n ∈ {100, 500, 1000}** and Monte‑Carlo reps **M**.

Artifacts:
- Raw streams and summaries in `results/raw/…csv`.
- Figures in `results/figures/`.

---

## E — Estimands
- **Prior mass**: F(Aₜ) with Aₜ=(−∞, t]; distribution Beta(α t, α(1−t)).
- **Posterior mass**: F(Aₜ) | x₁:ₙ ~ Beta(α t + kₙ(t), α(1−t) + n − kₙ(t)), kₙ(t)=∑1{xᵢ≤t}.
- **Predictive path**: Pₘ(t) = E[F(Aₜ) | x₁:ₘ] = (α t + Kₘ(t))/(α + m).
- **Section 2.4 target**: the **limit mass** F̃(t) of the Pólya empirical measure.
- **Prop. 2.6 CI** (predictive-only): Pₙ(t) ± z_{1−α/2} √(Vₙ,t/n), where Vₙ,t = (1/n)∑_{m=1}^n m²(Pₘ(t)−P_{m−1}(t))².

---

## M — Methods
### Part A (prior/posterior by continuation; your file’s mechanism)
- Fix a prefix x₁:ₙ from the urn; for each MC draw, **continue the same urn** to length M and record \hat p_M(t)=M^{-1}∑1{Xᵢ≤t}.
- Overlay **exact** Beta density on the histogram of \hat p_M(t) (prior: n=0; posterior: n>0).

### Part B (predictive diagnostics)
- Along the same streams, log **PIT** Uᵢ=P_{i−1}(Xᵢ), **convergence** distances (d^∞ and RMSE on a grid), and **paths** m↦Pₘ(t).

### Part C (Prop. 2.6)
- From logged paths {P₁(t),…,Pₙ(t)}, compute Vₙ,t and form CIs for **F̃(t)**.
- Obtain a **dataset-specific target** F̂(t) by *continuing the same urn* far into the tail (length L) and averaging 1{X≤t}.
- Coverage = 1{ F̂(t) ∈ CI } aggregated over MC datasets.

---

## P — Performance measures
- **Part A**: visual agreement of histograms with Beta overlays; empirical mean/variance ≈ analytic; CI coverage of Beta intervals.
- **Part B**: PIT ≈ Uniform(0,1); distances ↓ with i; Pₘ paths flatten with m.
- **Part C**: coverage near nominal and improving with n; mean CI width ↓ with n; standardized errors Z = (Pₙ−F̂)/√(Vₙ/n) ≈ Normal.
